<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LLM Cost Analyzer</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Load Chart.js for visualization -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Configure Tailwind to use Poppins and Indigo palette to match the portfolio -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Poppins', 'sans-serif'],
                    },
                    colors: {
                        'primary-indigo': '#4f46e5', // Indigo-600 from portfolio
                        'secondary-blue': '#3B82F6', // Blue-500 for chart highlights
                        'light-bg': '#F3F4F6', // Gray-100 from portfolio body
                        'card-bg': '#FFFFFF', // White
                        'sidebar-bg': '#E5E7EB', // Gray-200 for accents
                        'text-color': '#1F2937', // Gray-800
                        'footer-bg': '#1F2937', // Gray-800
                    },
                    boxShadow: {
                        'custom': '0 4px 12px rgba(0, 0, 0, 0.1)',
                    }
                }
            }
        }
    </script>
    <style>
        .input-card {
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            transition: transform 0.2s;
        }
        .input-card:hover {
            transform: translateY(-2px);
        }
    </style>
</head>
<body class="bg-light-bg font-sans text-text-color antialiased min-h-screen flex flex-col">

    <!-- Navbar (Matches Portfolio Navbar Style) -->
    <nav class="bg-white/80 backdrop-blur-md sticky top-0 z-50 shadow-sm">
        <div class="max-w-7xl mx-auto px-4 py-3 flex justify-between items-center">
            <a href="portfolio.html" class="text-2xl font-bold text-primary-indigo hover:text-indigo-700 transition-colors">
                <i class="fas fa-arrow-left text-xl mr-2"></i> Back to Portfolio
            </a>
            <div class="flex items-center space-x-5">
                <a href="portfolio.html#tools" class="hidden md:inline-block bg-primary-indigo text-white py-2 px-5 rounded-full hover:bg-indigo-700 transition">Go to Tools Section</a>
            </div>
        </div>
    </nav>

    <main class="max-w-7xl mx-auto px-4 py-12 flex-grow">
        <h1 class="text-4xl font-extrabold text-text-color text-center mb-10">
            LLM Model Cost Analyzer
        </h1>

        <!-- Top Section: Model Pricing Configuration -->
        <section class="bg-card-bg p-8 rounded-xl shadow-custom mb-10">
            <h2 class="text-2xl font-bold text-primary-indigo border-b border-gray-200 pb-3 mb-6">
                1. Configure LLM Pricing (per 1M tokens)
            </h2>
            <p class="text-gray-600 mb-4">
                Enter the pricing details for the models you want to compare. We use mock data for major models; you can override these values.
            </p>
            
            <div id="pricing-inputs" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Inputs generated by JS -->
            </div>
        </section>

        <!-- Middle Section: Use Case Definition -->
        <section class="bg-card-bg p-8 rounded-xl shadow-custom mb-10">
            <h2 class="text-2xl font-bold text-primary-indigo border-b border-gray-200 pb-3 mb-6">
                2. Define Use Case Token Parameters
            </h2>
            <p class="text-gray-600 mb-6">
                Select a scenario and adjust the token counts to match your expected workload.
            </p>

            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <!-- Use Case Select -->
                <div class="lg:col-span-1">
                    <label for="use-case-select" class="block text-sm font-medium text-text-color mb-2">Select Scenario</label>
                    <select id="use-case-select" class="w-full p-3 rounded-lg bg-sidebar-bg border border-gray-300 focus:ring-primary-indigo focus:border-primary-indigo text-text-color font-semibold">
                        <!-- Options populated by JS -->
                    </select>
                </div>

                <!-- Input/Output/Reasoning Tokens for current scenario -->
                <div class="lg:col-span-2 grid grid-cols-1 md:grid-cols-3 gap-4 bg-sidebar-bg p-4 rounded-lg">
                    <div>
                        <label for="input-tokens" class="block text-sm font-medium text-text-color mb-2">Input Tokens (Prompt Context)</label>
                        <input type="number" id="input-tokens" value="8000" min="10" class="w-full p-2 rounded-lg border border-gray-300">
                    </div>
                    <div>
                        <label for="output-tokens" class="block text-sm font-medium text-text-color mb-2">Output Tokens (Response)</label>
                        <input type="number" id="output-tokens" value="2000" min="10" class="w-full p-2 rounded-lg border border-gray-300">
                    </div>
                    <div>
                        <label for="api-calls" class="block text-sm font-medium text-text-color mb-2">API Calls (Per Period)</label>
                        <input type="number" id="api-calls" value="1000" min="1" class="w-full p-2 rounded-lg border border-gray-300">
                    </div>
                    <!-- Reasoning tokens field can be added here if needed, but simplifying for initial POC -->
                </div>
            </div>
            
            <button id="calculate-btn" class="mt-8 w-full py-3 px-4 bg-primary-indigo text-white font-semibold rounded-lg shadow-md hover:bg-indigo-700 transition duration-150">
                <i class="fas fa-calculator mr-2"></i> Calculate Estimated Costs
            </button>
        </section>

        <!-- Bottom Section: Results & Visualization -->
        <section class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <!-- Cost Comparison Chart -->
            <div class="lg:col-span-2 p-6 bg-card-bg rounded-xl shadow-custom">
                <h2 class="text-2xl font-bold text-text-color mb-4 border-b border-gray-200 pb-2">
                    3. Estimated Cost Comparison (Per 1,000 API Calls)
                </h2>
                <div class="h-96">
                    <canvas id="costChart"></canvas>
                </div>
                <p id="chart-caption" class="text-center text-sm text-gray-500 mt-4">
                    Costs are calculated based on the defined token parameters above.
                </p>
            </div>
            
            <!-- Detailed Table Results -->
            <div class="lg:col-span-1 p-6 bg-card-bg rounded-xl shadow-custom">
                <h2 class="text-2xl font-bold text-text-color mb-4 border-b border-gray-200 pb-2">
                    Detailed Estimates
                </h2>
                <div class="overflow-x-auto">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-sidebar-bg">
                            <tr>
                                <th class="px-4 py-3 text-left text-xs font-medium text-primary-indigo uppercase tracking-wider">Model</th>
                                <th class="px-4 py-3 text-right text-xs font-medium text-primary-indigo uppercase tracking-wider">Cost (USD)</th>
                            </tr>
                        </thead>
                        <tbody id="results-table-body" class="divide-y divide-gray-200">
                            <tr><td colspan="2" class="text-center py-8 text-gray-500">Click 'Calculate Estimated Costs' to see results.</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

    </main>

    <!-- Footer (Simplified to match portfolio) -->
    <footer class="bg-gray-800 text-white mt-16">
        <div class="max-w-7xl mx-auto py-6 px-4 text-center">
            <p>Â© 2025 Anshul Jain. All Rights Reserved. | <a href="portfolio.html" class="text-primary-indigo hover:text-white transition-colors">Back to Portfolio Home</a></p>
        </div>
    </footer>


    <!-- JavaScript Logic -->
    <script>
        // --- 1. CONFIGURATION AND MOCK DATA ---
        
        const MODEL_PRICING = [
            { name: "GPT-4o", inputPrice: 5.00, outputPrice: 15.00, color: '#3B82F6' },
            { name: "Gemini 2.5 Flash", inputPrice: 0.35, outputPrice: 0.70, color: '#F59E0B' },
            { name: "Mistral Large", inputPrice: 8.00, outputPrice: 24.00, color: '#10B981' },
            { name: "Claude 3 Opus", inputPrice: 15.00, outputPrice: 75.00, color: '#EF4444' },
            { name: "GPT-3.5 Turbo", inputPrice: 0.50, outputPrice: 1.50, color: '#06B6D4' },
            // Prices are per 1 Million Tokens ($USD)
        ];

        const USE_CASES = {
            'chatbot': {
                name: 'Chatbot Conversation',
                inputTokens: 1000,
                outputTokens: 2500,
                apiCalls: 10000,
                description: 'Estimates costs for typical conversational AI applications (e.g., customer support).'
            },
            'code_gen': {
                name: 'Code Generation',
                inputTokens: 8000,
                outputTokens: 2000,
                apiCalls: 1000,
                description: 'Suitable for estimating costs for feature development where moderate context understanding is required.'
            },
            'large_doc': {
                name: 'Large Document Processing',
                inputTokens: 300000,
                outputTokens: 30000,
                apiCalls: 100,
                description: 'Represents processing documents of substantial length (e.g., a 200-page book or legal manual).'
            }
        };

        let costChart;

        // --- 2. CORE CALCULATION LOGIC ---

        // Helper function to convert 1M token price to per-token price
        const PRICE_CONVERSION_FACTOR = 1000000;

        /**
         * Calculates the total cost for a given model based on usage parameters.
         * @param {number} inputPrice - Input token price per 1M tokens ($USD)
         * @param {number} outputPrice - Output token price per 1M tokens ($USD)
         * @param {number} inputTokens - Tokens per API call
         * @param {number} outputTokens - Tokens per API call
         * @param {number} apiCalls - Total number of API calls
         * @returns {number} Total estimated cost in $USD
         */
        function calculateTotalCost(inputPrice, outputPrice, inputTokens, outputTokens, apiCalls) {
            const totalInputTokens = inputTokens * apiCalls;
            const totalOutputTokens = outputTokens * apiCalls;
            
            const costInput = (totalInputTokens / PRICE_CONVERSION_FACTOR) * inputPrice;
            const costOutput = (totalOutputTokens / PRICE_CONVERSION_FACTOR) * outputPrice;
            
            return costInput + costOutput;
        }

        /**
         * Orchestrates the calculation and updates the chart and table.
         */
        function handleCalculation() {
            const inputTokens = parseInt(document.getElementById('input-tokens').value, 10);
            const outputTokens = parseInt(document.getElementById('output-tokens').value, 10);
            const apiCalls = parseInt(document.getElementById('api-calls').value, 10);

            if (isNaN(inputTokens) || isNaN(outputTokens) || isNaN(apiCalls) || apiCalls <= 0) {
                alert('Please ensure all token counts and API calls are valid positive numbers.');
                return;
            }

            const modelCosts = [];

            // Get current model pricing from UI, allowing user override
            const currentPricing = MODEL_PRICING.map(model => {
                const inputElement = document.getElementById(`input-${model.name.replace(/\s/g, '_')}`);
                const outputElement = document.getElementById(`output-${model.name.replace(/\s/g, '_')}`);
                
                return {
                    name: model.name,
                    inputPrice: parseFloat(inputElement.value),
                    outputPrice: parseFloat(outputElement.value),
                    color: model.color
                };
            });

            // Calculate costs for each model
            currentPricing.forEach(model => {
                const totalCost = calculateTotalCost(
                    model.inputPrice, 
                    model.outputPrice, 
                    inputTokens, 
                    outputTokens, 
                    apiCalls
                );
                modelCosts.push({
                    name: model.name,
                    cost: totalCost,
                    color: model.color
                });
            });

            // Sort by cost for table/chart
            modelCosts.sort((a, b) => a.cost - b.cost);
            
            renderChart(modelCosts, apiCalls);
            renderTable(modelCosts);
        }

        // --- 3. RENDERING LOGIC ---

        function renderChart(modelCosts, apiCalls) {
            if (costChart) {
                costChart.destroy();
            }

            const ctx = document.getElementById('costChart').getContext('2d');
            
            const labels = modelCosts.map(m => m.name);
            const data = modelCosts.map(m => m.cost);
            const colors = modelCosts.map(m => m.color);

            costChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: `Total Estimated Cost for ${apiCalls.toLocaleString()} API Calls`,
                        data: data,
                        backgroundColor: colors.map(c => c + 'CC'), // 80% opacity
                        borderColor: colors,
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: { display: true, text: 'Total Cost (USD)', color: '#4F46E5' },
                            ticks: {
                                callback: function(value) { return '$' + value.toFixed(2); }
                            }
                        },
                        x: {
                            grid: { display: false }
                        }
                    },
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.dataset.label + ': $' + context.parsed.y.toFixed(2);
                                }
                            }
                        }
                    }
                }
            });

            document.getElementById('chart-caption').textContent = `Cost comparison for ${apiCalls.toLocaleString()} API calls using current parameters.`;
        }

        function renderTable(modelCosts) {
            const tbody = document.getElementById('results-table-body');
            tbody.innerHTML = '';

            modelCosts.forEach((model, index) => {
                const row = tbody.insertRow();
                row.className = 'hover:bg-gray-50 transition duration-150';
                
                const nameCell = row.insertCell(0);
                nameCell.className = `px-4 py-3 whitespace-nowrap font-semibold text-sm ${index === 0 ? 'text-primary-indigo' : 'text-text-color'}`;
                nameCell.textContent = model.name;

                const costCell = row.insertCell(1);
                costCell.className = `px-4 py-3 whitespace-nowrap text-right font-bold text-sm ${index === 0 ? 'text-primary-indigo' : 'text-text-color'}`;
                costCell.textContent = `$${model.cost.toFixed(2)}`;
            });
        }

        // --- 4. INITIALIZATION ---

        function initializePricingInputs() {
            const container = document.getElementById('pricing-inputs');
            container.innerHTML = MODEL_PRICING.map(model => `
                <div class="input-card bg-sidebar-bg p-4 rounded-lg">
                    <h3 class="font-bold text-text-color mb-3">${model.name}</h3>
                    <div class="space-y-3">
                        <div>
                            <label for="input-${model.name.replace(/\s/g, '_')}" class="block text-xs font-medium text-gray-600 mb-1">Input Price ($/1M tokens)</label>
                            <input type="number" id="input-${model.name.replace(/\s/g, '_')}" value="${model.inputPrice.toFixed(2)}" step="0.01" min="0" class="w-full p-2 rounded-md border border-gray-300">
                        </div>
                        <div>
                            <label for="output-${model.name.replace(/\s/g, '_')}" class="block text-xs font-medium text-gray-600 mb-1">Output Price ($/1M tokens)</label>
                            <input type="number" id="output-${model.name.replace(/\s/g, '_')}" value="${model.outputPrice.toFixed(2)}" step="0.01" min="0" class="w-full p-2 rounded-md border border-gray-300">
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function initializeUseCases() {
            const select = document.getElementById('use-case-select');
            select.innerHTML = '';

            Object.keys(USE_CASES).forEach(key => {
                const option = document.createElement('option');
                option.value = key;
                option.textContent = USE_CASES[key].name;
                select.appendChild(option);
            });

            select.addEventListener('change', updateUseCaseParams);
            updateUseCaseParams(); // Load initial values
        }

        function updateUseCaseParams() {
            const selectedKey = document.getElementById('use-case-select').value;
            const params = USE_CASES[selectedKey];

            document.getElementById('input-tokens').value = params.inputTokens;
            document.getElementById('output-tokens').value = params.outputTokens;
            document.getElementById('api-calls').value = params.apiCalls;
        }

        function initializeAnalyzer() {
            initializePricingInputs();
            initializeUseCases();
            document.getElementById('calculate-btn').addEventListener('click', handleCalculation);
            // Run initial calculation to show default state
            handleCalculation(); 
        }

        document.addEventListener('DOMContentLoaded', initializeAnalyzer);
    </script>
</body>
</html>
